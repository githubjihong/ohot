package com.ohot.service.impl;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;

import com.ohot.mapper.ReportFormMapper;
import com.ohot.service.ReportFormService;
import com.ohot.util.UploadController;
import com.ohot.vo.ReportmanageVO;

import lombok.extern.slf4j.Slf4j;

@Slf4j
@Service
public class ReportFormServiceImpl implements ReportFormService{
	
	@Autowired
	ReportFormMapper reportFormMapper;
	
	@Autowired
	UploadController uploadController;
	
	@Override
	public ReportmanageVO reportFormVODetail(ReportmanageVO reportmanageVO) {

		return this.reportFormMapper.reportFormVODetail(reportmanageVO);
	}

	
	//신고 insert
	@Override
	public int editPost(ReportmanageVO reportmanageVO) {
		
		/*
		ReportmanageVO(reportPostNo=0, reportBoardNo=1, reportTitle=null, reportCn=fsda, reportRegDt=null, 
		reportChgDt=null, reportDelYn=null, memNo=2, reportCnt=0, reportTermination=null, memberVO=null, memName=null, 
		memLastName=null, memFirstName=null, memNicknm=null, memEmail=null, memTelno=null, memBirth=null, memPswd=null, 
		joinYmd=null, secsnYmd=null, memAccessToken=null, enabled=0, memStatSecCodeNo=null, memSecCodeNo=null, 
		memDelYn=null, pictureUrl=null, uploadFile=[파일객체], fileGroupNo=0, fileRegdate=null)
		 */
		//파일업로드
		MultipartFile[] multipartFile = reportmanageVO.getUploadFile();
		long fileGroupNo = this.uploadController.multiImageUpload(multipartFile);
		log.info("fileGroupNo : " + fileGroupNo);
		
		reportmanageVO.setFileGroupNo(fileGroupNo);
		
		log.info("editPost->reportmanageVO(최종): {}", reportmanageVO);
		
		return this.reportFormMapper.editPost(reportmanageVO);
	}


	@Override
	public List<ReportmanageVO> reportList(ReportmanageVO reportmanageVO) {
		return this.reportFormMapper.reportList(reportmanageVO);
	}
	
}
